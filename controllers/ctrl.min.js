(function(){
    /*global angular*/
    var mundial = angular.module("mundial");
    
    mundial.controller("BairrosController",['$scope','$log','$uibModal', 'BairrosService', function($scope,$log, $uibModal, BairrosService){
        
        $scope.title = "Bairros";
        $scope.arrayBairros = BairrosService.query();
        
        $scope.bairro = {}; ////////////////////////////////
        
        var appScopeModal = {
            showInfo : function(row) {
                
                var modalInstance = $uibModal.open({
                    controller: 'DetalheBairroController',
                    templateUrl: 'ngTemplate/detalheBairro.html',
                    resolve: {
                        selectedRow: function () {        
                        debugger;
                        $scope.bairro = row.entity; //////////////////////////////
                        return row.entity;
                        }
                    }
                });
            
                modalInstance.result.then(function (selectedItem) {
                    $log.log('modal selected Row: ' + selectedItem);
                }, function () {
                    $log.info('Modal dismissed at: ' + new Date());
                });
              }
        };
        
        $scope.gridBairros = angular.defaultGridConfig;
        $scope.gridBairros.appScopeProvider = appScopeModal;
        $scope.gridBairros.data = $scope.arrayBairros;
        $scope.gridBairros.columnDefs = [
          {field: 'cod_bairro', displayName: 'Código'},
          {field: 'nom_bairro', displayName: 'Nome', enableCellEdit:true },
          {field: 'cod_estado', displayName: 'Estado'},
          {field: 'cod_municipio', displayName: 'Município'},
          
          //{name: 'edit', displayName: 'Editar', cellTemplate: '<button id="editBtn" type="button" class="btn-small" ng-click="edit(row.entity)" >Editar</button> '}
        ];
        
        //eventos da página
        $scope.ok = function(){
            alert("OK");  
        };
        
        $scope.salvar = function(){
            debugger;    
            //ADICIONAR A VALIDAÇÃO
    
            BairrosService.save(function(){
                
                // INCLUIR O NOVO OBJETO NO ARRAY DO GRID
                $scope.arrayBairros.push(bairro);
                
                // LIMPAR OS TEXTBOXES 
            });
        }; // fim do salvar
        
        $scope.atualizar = function(){
            debugger;
            BairrosService.update({ id : bairro.cod_bairro }, bairro);    
        };// fim do atualizar
        
    }]); //fim do Controller
    
     mundial.controller('DetalheBairroController', 
    ['$scope', '$uibModal', '$uibModalInstance', '$filter', '$interval', 'selectedRow', 'ClientesService',
        function ($scope, $uibModal, $uibModalInstance, $filter, $interval, selectedRow, ClientesService) {
    
            $scope.selectedRow = selectedRow;
    
           $scope.ok = function () {
                $scope.selectedRow = null;
                $uibModalInstance.close();
            };
    
            $scope.cancel = function () {
                $scope.selectedRow = null;
                $uibModalInstance.dismiss('cancel');
            };
            
            $scope.salvar = function(c){
                debugger;
                ClientesService.save(c, function(){
                    console.log('salvo');
                    alert(c.nom_cliente);
                });
            
            };
        }
    ]); // fim da definição do controller de detalhe
    
})();
/*

*/
(function () {
    "use strict";
    /*global angular*/
    
    var mundial = angular.module("mundial");
    
    mundial.controller("ClientesController", ['$scope', '$cookies', '$log', '$uibModal', 'ClientesService', 'uiGridConstants', 'uiGridGroupingConstants', '$location','$http', function ($scope, $cookies, $log, $uibModal, ClientesService, uiGridConstants, uiGridGroupingConstants, $location, $http) {
        
        debugger;
        var usuario = $cookies.getObject('usuario');
        if (!usuario) {
            $location.url('/login');
        }
        
        $scope.cli = {};
        $scope.title = "Clientes";
                       
        $scope.salvar = function (cli) {
            
           ClientesService.save(cli, function onSuccess(d){
               debugger;
               $scope.cli = {};
               
           }, function onError(e){
               
               console.log(e);
           });        
        };
        
        /*var arrayClientes = ClientesService.query(function(){
            
            console.log("");
        /});
        
        var umCliente = ClientesService.get({ id: 1 }, function() {
            debugger;
            console.log(umCliente);
        }); // get() returns a single entry
        */
        
        /* var appScopeModal = {

            showInfo : function(row) {
                
                var modalInstance = $uibModal.open({
                    controller: 'DetalheClienteController',
                    templateUrl: 'ngTemplate/detalheCliente.html',
                    resolve: {
                      selectedRow: function () {                    
                          return row.entity;
                      }
                    }
                });
            
                modalInstance.result.then(function (selectedItem) {
                    $log.log('modal selected Row: ' + selectedItem);
                }, function () {
                    $log.info('Modal dismissed at: ' + new Date());
                });
            }
        };
        
        $scope.gridClientes = angular.defaultGridConfig;
        $scope.gridClientes.appScopeProvider = appScopeModal;
        //$scope.gridClientes.data = arrayClientes;
        $scope.gridClientes.data = [];
        $scope.gridClientes.columnDefs =  [
              //{field: 'cod_cliente', displayName: 'Código', enableCellEdit:false, aggregationType: uiGridConstants.aggregationTypes.max, hidden:true},
              {field: 'nom_cliente', displayName: 'Nome'},
              {field: 'num_telefone1', displayName: 'Telefone'},
              {field: 'nom_municipio', enableCellEdit:true, displayName: 'Município'},
              {field: 'dsc_sigla_estado', enableCellEdit:true, displayName: 'UF'},
              {field: 'sit_cliente', enableCellEdit:true, displayName: 'Situação'},
              //{name: 'edit', displayName: 'Editar', cellTemplate: '<button id="editBtn" type="button" class="btn-small" ng-click="editar(row.entity)" >Editar</button> '}
        ];
        */
        
/*
                                    cod_cliente = c.cod_cliente,
                                    nom_cliente = c.nom_cliente,
                                    num_telefone1 = c.num_telefone1,
                                    nom_municipio = m.nom_municipio,
                                    dsc_sigla_estado = es.dsc_sigla_estado,
                                    sit_cliente = c.sit_cliente
*/        
        
        
        // recuperando o valor de um cookie
        
        
        
    }]); //fim da definição do controller
    /*
    mundial.controller('DetalheClienteController', ['$scope', '$uibModal', '$uibModalInstance', '$filter', '$interval', 'selectedRow', 'ClientesService', function ($scope, $uibModal, $uibModalInstance, $filter, $interval, selectedRow, ClientesService) {
    
            $scope.selectedRow = selectedRow;
    
           $scope.ok = function () {
                $scope.selectedRow = null;
                $uibModalInstance.close();
            };
    
            $scope.cancel = function () {
                $scope.selectedRow = null;
                $uibModalInstance.dismiss('cancel');
            };
            
            $scope.atualizar = function(c){
                debugger;
                ClientesService.update({id: c.cod_cliente},c , function(){
                    debugger;
                    console.log('salvo');
                    alert(c.nom_cliente);
                });
            
            };
        }
    ]); // fim da definição do controller de detalhe
    */
})();
(function(){
    
    /*global angular*/
    
    var mundial = angular.module("mundial");
    
    mundial.controller("ContinentesController",['$scope','$cookies','$log','$uibModal', 'ContinentesService','uiGridConstants', 'uiGridGroupingConstants', function($scope, $cookies, $log, $uibModal, ContinentesService,uiGridConstants,uiGridGroupingConstants){
        debugger;
        
        $scope.title = "Continentes";
        
        var arrayClientes = ContinentesService.query();
        
        //var umContinente = ContinentesService.get({ id: 1 }, function() {
        //    debugger;
        //    console.log(umContinente);
        //}); // get() returns a single entry
        
         var appScopeModal = {

            showInfo : function(row) {
                
                var modalInstance = $uibModal.open({
                    controller: 'DetalheContinenteController',
                    templateUrl: 'ngTemplate/detalheContinente.html',
                    resolve: {
                      selectedRow: function () {                    
                          return row.entity;
                      }
                    }
                });
            
                modalInstance.result.then(function (selectedItem) {
                    $log.log('modal selected Row: ' + selectedItem);
                }, function () {
                    $log.info('Modal dismissed at: ' + new Date());
                });
            }
        };
        
        $scope.gridContinentes = angular.defaultGridConfig;
        $scope.gridContinentes.appScopeProvider = appScopeModal;
        $scope.gridContinentes.data = arrayClientes;
        $scope.gridContinentes.columnDefs =  [
              //{field: 'cod_cliente', displayName: 'Código', enableCellEdit:false, aggregationType: uiGridConstants.aggregationTypes.max, hidden:true},
              {field: 'nom_continente', displayName: 'Continente'},
              {field: 'sit_continente', enableCellEdit:true, displayName: 'Situação'},
              //{name: 'edit', displayName: 'Editar', cellTemplate: '<button id="editBtn" type="button" class="btn-small" ng-click="editar(row.entity)" >Editar</button> '}
        ];
        
        // recuperando o valor de um cookie
        var usuario = $cookies.getObject('usuario');

    }]); //fim da definição do controller
    
    mundial.controller('DetalheContinenteController', 
    ['$scope', '$uibModal', '$uibModalInstance', '$filter', '$interval', 'selectedRow', 'ContinentesService',
        function ($scope, $uibModal, $uibModalInstance, $filter, $interval, selectedRow, ContinentesService) {
    
            $scope.selectedRow = selectedRow;
    
           $scope.ok = function () {
                $scope.selectedRow = null;
                $uibModalInstance.close();
            };
    
            $scope.cancel = function () {
                $scope.selectedRow = null;
                $uibModalInstance.dismiss('cancel');
            };
            
            $scope.atualizar = function(c){
                debugger;
                ClientesService.update({id: c.cod_cliente},c , function(){
                    debugger;
                    console.log('salvo');
                    alert(c.nom_cliente);
                });
            
            };
        }
    ]); // fim da definição do controller de detalhe
    
})();
(function(){
    var mundial = angular.module("mundial");
    
    mundial.controller("HomeController",['$scope', '$cookies','$location', function($scope, $cookies,$location){
        debugger;
        var usuario = $cookies.getObject('usuario');
        
        if (!usuario) {
            $location.url('/login');
        }
        
        $scope.mensagem = "Bem Vindo " + usuario.nom_usuario;
        
        
    }]);
})();
(function(){
    var mundial = angular.module("mundial");
    
    mundial.controller("LoginController",['$scope', '$cookies','$location', function($scope, $cookies,$location){
        debugger;
        $scope.mensagem = "Bem Vindo";
        
        $scope.usuario = {};
        
        $scope.autenticar = function(){
            debugger;
            if($scope.login === "admin" && $scope.senha === "admin"){
            
                $scope.usuario = {
                    cod_usuario : 3,
                    nom_usuario : "Gilberto Martini",
                    autenticado : true
                };
                // Definindo um cookie
                $cookies.putObject('usuario', $scope.usuario);
                
                $location.url('/');
                
            }else{
                alert("Usuário não autorizado");
                $cookies.remove('usuario');
                $location.url('/login');
            }    
        };
        
        
        
        
        
        
        
    }]);
})();
(function(){
    var mundial = angular.module("mundial");
    
    mundial.controller("RegioesController",['$scope', function($scope){
        
        $scope.title = "Regioes do controller";
        
    }]);
})();
(function(){
    /*global angular*/
    
    var mundial = angular.module('mundial');
   
    mundial.factory('ClientesService',['$resource', function ($resource){
      
      /*
      return $resource("https://mundialerp.gear.host/api/clientes/:id", null, {
            'update': { method:'PUT' }
      });
      */
                  
      return $resource("http://localhost:55432/api/clientes/:id", { id: "@cod_cliente" }, {        
        'update': { method:'PUT' },
        'save': {
            method :'POST',
            headers: {
            'Content-Type': 'application/json'
            }
        }  
      });
      
        
      
      
    }]); //fim da factory.              
})();
(function(){
    var mundial = angular.module('mundial');
   
    mundial.factory('BairrosService',['$resource', function ($resource){
      
      //return $resource("https://api.github.com/users");
      //return $resource("https://mundialerp.gear.host/api/bairros");
      
      return $resource('https://mundialerp.gear.host/api/bairros/:id', null, {
            'update': { method:'PUT' }
      });
      
    }]); //fim da factory.              
})();
(function(){
    /*global angular*/
    
    var mundial = angular.module('mundial');
   
    mundial.factory('LoginService',['$resource', function ($resource){
      
      /*
      return $resource("https://mundialerp.gear.host/api/clientes/:id", null, {
            'update': { method:'PUT' }
      });
      */
                  
      return $resource("http://localhost:55432/api/usuarios/:id", { id: "@cod_cliente" }, {        
        'update': { method:'PUT' },
        'save': {
            method :'POST',
            headers: {
            'Content-Type': 'application/json'
            }
        }  
      });
      
        
      
      
    }]); //fim da factory.              
})();